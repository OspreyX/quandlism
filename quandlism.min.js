(function(e){(function(){var t,n,r,i,s,o,u,a,f,l,c,h=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};i=e.quandlism={version:"0.7.4"},i.context=function(){var e,n,r,i,s,o,a,f,l,c,h,p,d,v=this;return n=new t,d=null,l=null,r=null,o=null,i=null,s=null,a=null,h=0,p=.7,f=d3.dispatch("respond","adjust","toggle","refresh"),e=["#e88033","#4eb15d","#c45199","#6698cb","#6c904c","#e9563b","#9b506f","#d2c761","#4166b0","#44b1ae"],c=[],n.attachData=function(e){return c=n.utility().buildLines(e),c=n.utility().processLines(c,e),n.bindToElements(),n},n.updateData=function(e){return c=n.utility().mergeLines(c,e),c=n.utility().processLines(c,e),n.bindToElements(),n},n.bindToElements=function(){return o&&d3.select(o).datum(c),i&&d3.select(i).datum(c),s&&d3.select(s).datum(c),n},n.render=function(){return n.build(),o&&d3.select(o).call(n.stage()),i&&d3.select(i).call(n.brush()),s&&d3.select(s).call(n.legend()),n.respond(),n},n.update=function(){return n.build(),n.respond(),n.refresh(),n},n.build=function(){return d=$(r).width(),l=$(r).height(),n},n.chart=function(e,t){var s,a,f;if(!e.length)throw"Invalid container";return s=t!=null?t:!0,e.children().remove(),e.attr("id")==null&&e.attr("id","quandlism-"+ ++u),r="#"+e.attr("id"),f="quandlism-stage-"+ ++u,e.append("<div class='stage' id='"+f+"'></div>"),o="#"+f,s&&(a="quandlism-brush-"+ ++u,e.append("<div class='brush' id='"+a+"'></div>"),i="#"+a),n},n.setupWithContainer=function(e,t){return n.chart(e,t)},n.withLegend=function(e){if(!e.length)throw"Invalid container";return e.attr("id")||e.attr("id","quandlism-legend-"+ ++u),s="#"+e.attr("id"),n},n.legendWithSelector=function(e){return n.withLegend(e)},n.addColorsIfNecessary=function(t){var n,r,i,s;r=t.length-e.length;if(r<0)return;n=.1,i=0;while(i<r)s=d3.rgb(e[i]).brighter(n),e.push(s.toString()),i++},n.lines=function(e){return e?(c=e,n):c},n.colorList=function(t){return t==null?e:(e=t,n)},n.startPoint=function(e){return e==null?p:(p=e,n)},n.w=function(e){return e==null?d:(d=e,n)},n.h=function(e){return e==null?l:(l=e,n)},n.dom=function(e){return e==null?r:(r=e,n)},n.domstage=function(e){return e==null?o:(o=e,n)},n.dombrush=function(e){return e==null?i:(i=e,n)},n.domlegend=function(e){return e==null?s:(s=e,n)},n.padding=function(e){return e==null?h:(h=e,n)},n.respond=_.throttle(function(){return f.respond.call(n,500)}),n.adjust=function(e,t,r,i){return f.adjust.call(n,e,t,r,i)},n.toggle=function(){return f.toggle.call(n)},n.refresh=function(){return f.refresh.call(n)},n.on=function(e,t){return t==null?f.on(e):(f.on(e,t),n)},d3.select(window).on("resize",function(){var e,t;d3.event.preventDefault();if(r){t=$(r).width(),e=$(r).height();if(d!==t||l!==e)d=t,l=e,n.respond()}}),n},t=function(){function e(){}return e}(),n=t.prototype=i.context.prototype,s=0,a=0,u=0,c=40,l={h:.1},o={h:.15},f={h:.65},r=function(){function e(){}return e}(),n.line=function(e){var t,n,i,s,o,u,f,l,c,h=this;return u=new r,n=this,f=e.name,l=e.values.reverse(),i=[],s=[],o=a++,c=!1,t="#000000",u.setup=function(){var e;i=function(){var t,n,r;r=[];for(t=0,n=l.length;t<n;t++)e=l[t],r.push(e.date);return r}(),s=_.map(i,function(e){return n.utility().getDateKey(e)}),window.dates=i,s=s},u.setup(),u.extent=function(e,t){var n,r,i,s,o;n=e!=null?e:0,s=t!=null?t:this.length()-1,i=Infinity,r=-Infinity;if(!this.visible())return[i,r];while(n<=s){o=this.valueAt(n);if(o==null){n++;continue}o<i&&(i=o),o>r&&(r=o),n++}return[i,r]},u.extentByDate=function(e,t){var n,r,i,s,o,u,a,f;s=Infinity,i=-Infinity;if(!this.visible())return[s,i];f=this.dates();for(r=u=0,a=f.length;u<a;r=++u){n=f[r];if(!(n<=t&&n>=e))continue;o=this.valueAt(r);if(o==null)continue;o<s&&(s=o),o>i&&(i=o)}return[s,i]},u.length=function(){return l.length},u.valueAt=function(e){return l[e]!=null?l[e].num:null},u.dateAt=function(e){return i[e]!=null?i[e]:null},u.drawPointAtIndex=function(e,t,n,r,i){if(!this.visible())return;return e.beginPath(),e.arc(t(this.dateAt(r)),n(this.valueAt(r)),i,0,Math.PI*2,!0),e.fillStyle=this.color(),e.fill(),e.closePath()},u.drawPath=function(e,t,n,r){var i,s,o,u,a;if(!this.visible())return;e.beginPath(),a=this.dates();for(s=o=0,u=a.length;o<u;s=++o){i=a[s];if(this.valueAt(s)==null)continue;e.lineTo(t(i),n(this.valueAt(s)))}e.lineWidth=r,e.strokeStyle=this.color(),e.stroke(),e.closePath()},u.drawPathFromIndicies=function(e,t,n,r,i,s){var o,u;if(!this.visible())return;e.beginPath();for(o=u=r;r<=i?u<=i:u>=i;o=r<=i?++u:--u){if(this.valueAt(o)==null)continue;e.lineTo(t(this.dateAt(o)),n(this.valueAt(o)))}return e.lineWidth=s,e.strokeStyle=this.color(),e.stroke(),e.closePath()},u.getClosestDataPoint=function(e){var t;return t=this.getClosestIndex(e),l[t]},u.getClosestIndex=function(e){var t,r,i,o,u,a,f,l,c,h,p;r=Infinity,t=0,c=Infinity,u=n.utility().getDateKey(e);for(f=h=0,p=s.length;h<p;f=++h){o=s[f],l=n.utility().getDateKey(o),a=Math.abs(l-u);if(a<r)c=r,r=a,i=f;else if(c<a)break}return i},u.drawPoints=function(e,t,n,r,i,s){var o,u,a,f,l,c;if(!this.visible())return;l=this.dates(),c=[];for(u=a=0,f=l.length;a<f;u=++a){o=l[u];if(!(o>=r&&o<=i))continue;e.beginPath(),e.arc(t(o),n(this.valueAt(u)),3,0,Math.PI*2,!0),e.fillStyle=this.color(),e.fill(),c.push(e.closePath())}return c},u.toggle=function(){var e;return e=!this.visible(),this.visible(e),e},u.dates=function(e){return e==null?i:(i=e,u)},u.id=function(e){return e==null?o:(o=e,u)},u.name=function(e){return e==null?f:(f=e,u)},u.values=function(e){return e==null?l:(l=e,u)},u.visible=function(e){return e==null?c:(c=e,u)},u.color=function(e){return e==null?t:(t=e,u)},u},n.timeScale=function(){var e,t;return e=this,t=d3.time.scale()},n.stage=function(){var e,t,n,r,i,s,o,a,h,p,d,v,m,g,y,b,w,E,S,x,T,N=this;return n=this,t=null,g=[],m=null,w=Math.floor(n.w()-c-2),p=Math.floor(n.h()*f.h),S=d3.time.scale(),T=d3.scale.linear(),E=d3.svg.axis().orient("bottom").scale(S),x=d3.svg.axis().orient("left").scale(T),h=[],b=10,s=null,i=null,a=null,o=null,v=null,d=null,b=10,e=null,r=null,y=function(o){var a,y,N,C,k,L,A,O,M;t==null&&(t="canvas-stage-"+ ++u),g=o.datum(),m=_.first(g),o.attr("style","position: absolute; left: 0px; top: 0px;"),M=o.insert("svg"),M.attr("class","y axis"),M.attr("id","y-axis-"+t),M.attr("width",c),M.attr("height",Math.floor(n.h()*f.h)),M.attr("style","position: absolute; left: 0px; top: 0px;"),e=o.append("canvas"),e.attr("width",w),e.attr("height",p),e.attr("class","stage"),e.attr("id",t),e.attr("style","position: absolute; left: "+c+"px; top: 0px;"),r=e.node().getContext("2d"),O=o.append("svg"),O.attr("class","x axis"),O.attr("id","x-axis-"+t),O.attr("width",Math.floor(n.w()-c)),O.attr("height",Math.floor(n.h()*l.h)),O.attr("style","position: absolute; left: "+c+"px; top: "+n.h()*f.h+"px"),A=function(){var e;h=n.utility().getExtent(g,v,d),h[0]===h[1]&&(h=n.utility().getExtent(g,0,m.length())),T.domain([h[0],h[1]]),T.range([p-n.padding(),n.padding()]),x.ticks(Math.floor(n.h()*f.h/30)),x.tickSize(5,3,0),e=n.utility().getUnitAndDivisor(Math.round(h[1])),x.tickFormat(function(t){var n;return n=(t/e.divisor).toFixed(2),n=n.replace(/0+$/,""),n=n.replace(/\.$/,""),""+n+" "+e.label}),S.domain([s,i]),S.range([n.padding(),w-n.padding()])},N=function(){var e,t;M.selectAll("*").remove(),t=M.append("g"),t.attr("transform","translate("+(c-1)+", 0)"),t.call(x),O.selectAll("*").remove(),e=O.append("g"),e.call(E)},C=function(){var e,t,i,s,o,u,a,l,h;a=T.ticks(Math.floor(n.h()*f.h/30));for(i=0,o=a.length;i<o;i++)t=a[i],r.beginPath(),r.strokeStyle="#EDEDED",r.lineWidth=1,r.moveTo(0,Math.floor(T(t))),r.lineTo(w,Math.floor(T(t))),r.stroke(),r.closePath();l=S.ticks(Math.floor((n.w()-c)/100)),h=[];for(s=0,u=l.length;s<u;s++)e=l[s],r.beginPath(),r.strokeStyle="#EDEDED",r.lineWith=1,r.moveTo(S(e),p),r.lineTo(S(e),0),r.stroke(),h.push(r.closePath());return h},y=function(e){var t,n,i,s,o,u;e=e!=null?e:-1,N(),r.clearRect(0,0,w,p),C();for(n=s=0,u=g.length;s<u;n=++s){m=g[n],i=n===e?3:1.5,m.drawPathFromIndicies(r,S,T,v,d,i);if(d-v<b)for(t=o=v;v<=d?o<=d:o>=d;t=v<=d?++o:--o)m.drawPointAtIndex(r,S,T,t,2)}},L=function(e){var t,i,s,o,u,a,f,l,c,h,p,d,v,m;t=n.utility().getPixelRGB(e,r),s=_.indexOf(n.colorList(),t);if(s!==-1)return{x:e[0],color:t,line:g[s]};i=[];for(o=f=h=e[0]-3,p=e[0]+3;h<=p?f<=p:f>=p;o=h<=p?++f:--f)for(u=l=d=e[1]-3,v=e[1]+3;d<=v?l<=v:l>=v;u=d<=v?++l:--l)(o!==e[0]||u!==e[1])&&i.push([o,u]);for(a=c=0,m=i.length-1;0<=m?c<=m:c>=m;a=0<=m?++c:--c){t=n.utility().getPixelRGB(i[a],r),s=_.indexOf(n.colorList(),t);if(s!==-1)return{x:i[a][0],color:t,line:g[s]}}return!1},k=function(e,t,i){var s,o,u,a,f,l;u=t.line,s=u.dateAt(i),f=u.valueAt(i),y(u.id()),u.drawPointAtIndex(r,S,T,i,3),o=e[1]<=20&&e[0]>=w-250,l=o?w-400:w,r.beginPath(),r.fillStyle="rgba(237, 237, 237, 0.80)",r.fillRect(l-240,0,240,15),r.closePath(),r.fillStyle="#000",r.textAlign="start",a=""+n.utility().getMonthName(s.getUTCMonth())+"  "+s.getUTCDate()+", "+s.getFullYear()+": ",a+=""+n.utility().formatNumberAsString(f.toFixed(2)),r.fillText(a,l-110,10,100),r.fillStyle=u.color(),r.textAlign="end",r.fillText(""+n.utility().truncate(u.name(),20),l-120,10,200)},a=function(){y()},n.dombrush()==null&&(s=_.first(g[0].dates()),i=_.last(g[0].dates()),v=0,d=m.length(),A(),y()),n.on("respond.stage",function(){r.clearRect(0,0,w,p),w=Math.floor(n.w()-c-1),p=Math.floor(n.h()*f.h),e.attr("width",w),e.attr("height",p),M.attr("width",c),O.attr("width",Math.floor(n.w()-c)),A(),y()}),n.on("adjust.stage",function(e,t,n,r){v=t,d=r,s=e,i=n,A(),y()}),n.on("toggle.stage",function(){A(),y()}),n.on("refresh.stage",function(){g=o.datum(),m=_.first(g),n.dombrush()||y()}),d3.select("#"+t).on("mousemove",function(e){var t,n,r;r=d3.mouse(this),n=L(r),n&&(t=n.line.getClosestIndex(S.invert(n.x))),n!==!1?k(r,n,t):a()})},y.canvasId=function(e){return e==null?t:(t=e,y)},y.xScale=function(e){return e==null?S:(S=e,y)},y.yScale=function(e){return e==null?T:(T=e,y)},y.threshold=function(e){return e==null?b:(b=e,y)},y},n.brush=function(){var e,t,n,r,i,s,a,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,D,P,H,B=this;return a=this,E=Math.floor(a.h()*o.h),M=Math.floor(a.w()-c),d=p=y=g=S=null,m=v=k=A=null,i=h=s=n=null,b=x=[],P=d3.time.scale(),H=d3.scale.linear(),D=d3.svg.axis().orient("bottom").scale(P),L=10,w=10,C=6,N=100,e=0,r=document.createElement("canvas"),O=!1,T={},t=function(t){var n,b,N,B,j,F,I,q,R,U,z,W,X,V,$,J,K,Q,G,Y;return s==null&&(s="canvas-brush-"+ ++u),x=t.datum(),S=_.first(x),d=_.first(S.dates()),p=_.last(S.dates()),t.attr("style","position: absolute; top: "+a.h()*(f.h+l.h)+"px; left: "+c+"px"),i=t.append("canvas"),i.attr("id",s),i.attr("style","position: absolute; left: 0px; top: 0px"),h=i.node().getContext("2d"),Y=t.append("svg"),Y.attr("class","x axis"),Y.attr("id","x-axis-"+s),Y.attr("height",Math.floor(a.h()*l.h)),Y.attr("width",Math.floor(a.w()-c)),Y.attr("style","position: absolute; top: "+a.h()*o.h+"px; left: 0px"),n=function(){return S.length()<=C?(d=_.first(S.dates()),p=_.last(S.dates()),y=P(d),g=P(p),v=!1):v=!0},Q=function(){H.domain(a.utility().getExtent(x,null,null)),H.range([E-a.padding(),a.padding()]),P.range([a.padding(),M-a.padding()]),P.domain([_.first(S.dates()),_.last(S.dates())])},J=function(){d=S.dateAt(Math.floor(a.startPoint()*S.length())),p=_.last(S.dates()),y=P(d),g=P(p),K("dateStart",d),K("dateEnd",p),K("drawStart",y),K("drawEnd",g)},G=function(){b(),O?I():B(),F()},b=function(){h.clearRect(0,0,q("width"),q("height")),i.attr("width",M).attr("height",E)},j=function(){var e;Y.selectAll("*").remove(),e=Y.append("g"),e.call(D)},B=function(){var e,t,n;for(e=t=0,n=x.length;t<n;e=++t)S=x[e],S.drawPath(h,P,H,1);S.length()<=L&&S.drawPoints(h,P,H,_.first(S.dates(),_.last(S.dates()),3)),X()},I=function(){h.drawImage(r.canvas,0,0)},X=function(){O=!0,r.setAttribute("width",M),r.setAttribute("height",E),r=r.getContext("2d"),r.drawImage(document.getElementById(s),0,0)},F=function(){h.strokeStyle="rgba(237, 237, 237, 0.80)",h.beginPath(),h.fillStyle="rgba(237, 237, 237, 0.80)",h.fillRect(y,0,g-y,E),h.closePath(),h.beginPath(),h.fillStyle="#D9D9D9",h.fillRect(y-w,0,w,E),h.closePath(),h.beginPath(),h.fillStyle="#D9D9D9",h.fillRect(g,0,w,E),h.closePath()},W=function(){r=document.createElement("canvas"),O=!1},N=function(e){var t;e=e!=null?e:!1,e&&(d=P.invert(y),p=P.invert(g),d>p&&(t=p,p=d,d=t)),a.adjust(d,S.getClosestIndex(d),p,S.getClosestIndex(p))},V=function(){var t;m=!1,k=!1,e=0,y>g&&(t=g,g=y,y=t),d=P.invert(y),p=P.invert(g),K("drawStart",y),K("dateStart",d),K("drawEnd",g),K("dateEnd",p)},R=function(e){return e<=g&&e>=y},U=function(e){return e>=y-w&&e<y},z=function(e){return e>g&&e<=g+w},$=function(e){document.getElementById(""+a.dombrush().substring(1)).className=e},K=function(e,t){T[e]=t},q=function(e){var t;return(t=T[e])!=null?t:null},K("width",M),K("height",E),Q(),n(),v&&J(),j(),N(),setInterval(G,70),a.on("respond.brush",function(){K("height",E),K("width",M),E=Math.floor(a.h()*o.h),M=Math.floor(a.w()-c),W(),Q(),y=P(d),g=P(p),V(),Y.attr("width",M),j()}),a.on("refresh.brush",function(){x=t.datum(),S=_.first(x),W(),Q(),n(),v&&J(),j(),N()}),a.on("toggle.brush",function(){W(),Q()}),i.on("mousedown",function(t){var n;d3.event.preventDefault(),n=d3.mouse(this),A=n[0],U(n[0])?(k=!0,e=-1):z(n[0])?(k=!0,e=1):R(n[0])&&(m=!0)}),i.on("mouseup",function(e){N(!0),V()}),i.on("mouseout",function(e){N(!0),$(""),V()}),i.on("mousemove",function(t){var n,r;r=d3.mouse(this);if(m||k){n=r[0]-A;if(m&&v)y=q("drawStart")+n,g=q("drawEnd")+n;else if(k){if(e!==0&&e!==-1&&e!==1)throw"Error: Unknown stretching direction";e===-1&&(y=q("drawStart")+n),e===1&&(g=q("drawEnd")+n)}y=y<0?0:y,g=g>M?M:g}else v&&(R(r[0])?$("move"):U(r[0])||z(r[0])?$("resize"):$(""))})},t.canvasId=function(e){return e==null?s:(s=e,t)},t.xScale=function(e){return e==null?P:(P=e,t)},t.yScale=function(e){return e==null?H:(H=e,t)},t.threshold=function(e){return e==null?L:(L=e,t)},t.stretchLimit=function(e){return e==null?C:(C=e,t)},t.handleWidth=function(e){return e==null?w:(w=e,t)},t},n.xaxis=function(){var e,t,n,r,i,s,o,u,a,f,c,h=this;return n=this,f=n.w()*l.w,i=n.h()*l.h,a=d3.time.scale().range([0,f]),t=d3.svg.axis().scale(a),r=[],e=!1,o=[],s=null,u=null,c=function(h){var p,d;s=h.attr("id"),o=h.datum(),t.tickSize(5,3,0),d=function(){var e;return c.remove(),e=h.append("svg"),e.attr("width",f),e.attr("height",i),e.append("g"),e.attr("transform","translate(0, 27)"),e.call(t)},p=function(){return r=[o[0].dateAt(0),o[0].dateAt(o[0].length()-1)],u=n.utility().parseDate(o[0].dateAt(0)),a.domain([u(r[0]),u(r[1])]),t.tickFormat(d3.time.format("%b %d, %Y")),t.ticks(Math.floor(f/150,0,0)),a.range([0,f])},p(),d(),n.on("respond.xaxis-"+s,function(){return f=n.w()*l.w,t.ticks(Math.floor(f/150,0,0)),a.range([0,f]),d()}),n.on("refresh.xaxis-"+s,function(){return o=h.datum(),p(),d()}),e&&n.on("adjust.xaxis-"+s,function(e,t){return t=t>o[0].length()-1?o[0].length()-1:t,e=e<0?0:e,r=[o[0].dateAt(e),o[0].dateAt(t)],a.domain([u(r[0]),u(r[1])]),d()})},c.remove=function(){return d3.select("#"+s).selectAll("svg").remove()},c.active=function(t){return t?(e=t,c):e},d3.rebind(c,t,"orient","ticks","ticksSubdivide","tickSize","tickPadding","tickFormat")},n.yaxis=function(){var e,t,n,r,i,s,o,u,a,f,l,c=this;return t=this,u=t.w()*quandlism_yaxis.w,r=t.h()*quandlism_yaxis.h,o=d3.scale.linear().range([r,0]),e=d3.svg.axis().scale(o),s=[],n=[],f=null,a=null,i=null,l=function(c){var h,p;i=c.attr("id"),s=c.datum(),e.ticks(Math.floor(r/25,0,0)),e.tickSize(5,3,0),p=function(){var i,h;return n=t.utility().getExtent(s,f,a),o.domain([n[0],n[1]]),l.remove(),h=c.append("svg"),h.attr("width",u),h.attr("height","100%"),i=h.append("g"),i.attr("transform","translate("+(u-1)+", 0)"),i.attr("width",u),i.attr("height",r),i.call(e)},h=function(){a=s[0].length()-1,f=Math.floor(s[0].length()*t.endPercent())},h(),p(),t.on("toggle.y-axis-"+i,function(){p()}),t.on("refresh.y-axis-"+i,function(){s=c.datum(),h(),p()}),t.on("respond.y-axis-"+i,function(){u=t.w()*quandlism_yaxis.w,r=t.h()*quandlism_yaxis.h,e.ticks(Math.floor(r/25,0,0)),o.range([r,0]),p()}),t.on("adjust.y-axis-"+i+"}",function(e,t){f=e>0?e:0,a=t<s[0].length()?t:s[0].length(),p()})},l.remove=function(e){d3.select("#"+i).selectAll("svg").remove()},d3.rebind(l,e,"orient","ticks","ticksSubdivide","tickSize","tickPadding","tickFormat")},n.legend=function(){var e,t,n;return e=this,n=[],t=function(t){var r;r=function(){var r=this;n=t.datum(),t.selectAll("li").remove(),t.selectAll("li").data(n).enter().append("li").attr("style",function(e){return"color: "+e.color()}).attr("class",function(e){if(!e.visible())return"off"}).append("a",":first-child").attr("href","javascript:;").attr("data-line-id",function(e){return e.id()}).text(function(e){return e.name()}),t.selectAll("a").on("click",function(t,r){var i,s,o,u;i=d3.event,s=i.target,o=parseInt(s.getAttribute("data-line-id")),i.preventDefault(),u=_.find(n,function(e){return e.id()===o}),u!=null&&(u.toggle()===!1?$(s).parent().addClass("off"):$(s).parent().removeClass("off"),e.toggle())})},r(),e.on("refresh.legend",function(){r()})},t},n.utility=function(){var e,t,n=this;return e=this,t=function(){},t.truncate=function(e,t){return e.length>t?""+e.substring(0,t)+"...":e},t.buildLines=function(n){var r,i,s;return r=n.columns.slice(1),i=_.map(r,function(e,r){return t.getLineData(n.data,r)}),s=_.map(r,function(t,n){return e.line({name:t,values:i[n]})}),s},t.processLines=function(t,n){var r,i,s,o;e.addColorsIfNecessary(t);for(r=s=0,o=t.length;s<o;r=++s)i=t[r],i.color(e.colorList()[r]),n.show!=null&&n.show.length&&i.visible(h.call(n.show,r)>=0);return t},t.getLineData=function(e,t){var n;return n=d3.time.format("%Y-%m-%d"),_.map(e,function(e){return{date:n.parse(e[0]),num:e[t+1]}})},t.mergeLines=function(e,n){var r,i,s;e=t.addNewLinesAndRefresh(e,n),e=t.removeStaleLines(e,n.columns);for(i=0,s=e.length;i<s;i++)r=e[i],r.setup();return e},t.addNewLinesAndRefresh=function(n,r){var i,s,o,u,a,f,l,c,h,p,d;d=r.columns.slice(1);for(s=l=0,h=d.length;l<h;s=++l){i=d[s],o=!1,f=t.getLineData(r.data,s);for(u=c=0,p=n.length;c<p;u=++c){a=n[u];if(a.name()===i){o=!0,n[u].values(f.reverse());break}}o||(a=e.line({name:i,values:f}),n.push(a))}return n},t.removeStaleLines=function(e,t){return _.reject(e,function(e){var n;return n=e.name(),h.call(t,n)<0})},t.getExtent=function(e,t,n){var r,i;return r=function(){var r,s,o;o=[];for(r=0,s=e.length;r<s;r++)i=e[r],o.push(i.extent(t,n));return o}(),[d3.min(r,function(e){return e[0]}),d3.max(r,function(e){return e[1]})]},t.getExtentFromDates=function(e,t,n){var r,i;return r=function(){var r,s,o;o=[];for(r=0,s=e.length;r<s;r++)i=e[r],o.push(i.extentByDate(t,n));return o}(),[d3.min(r,function(e){return e[0]}),d3.max(r,function(e){return e[1]})]},t.getMonthName=function(e){var t;return t=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],t[e]},t.getColor=function(t){return e.colorList()[t]},t.formatNumberAsString=function(e){return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")},t.getPixelRGB=function(e,t){var n,r;return n=t.getImageData(e[0],e[1],1,1).data,r=d3.rgb(n[0],n[1],n[2]),r.toString()},t.getUnitAndDivisor=function(e){var t;return t=e.toString().length,t<=3?{label:"",divisor:1}:t<=6?{label:"K",divisor:1e3}:t<=9?{label:"M",divisor:1e6}:{label:"B",divisor:1e9}},t.getDateKey=function(e){return e==null?null:e.valueOf()},t}}).call(this)})(this);